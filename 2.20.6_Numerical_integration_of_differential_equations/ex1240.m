% y'=x^2+y^2
% y(0)=0
% h=0.1
% y(0.4)-?
clear
syms x y
x0=0
y0=0
h=0.1
f(x,y)=x^2+y^2
dy=x^2+y^2
dy0=subs(dy,[x,y],[x0,y0])  
% 0
d2y=2*x+2*y*dy
d2y0=subs(d2y,[x,y,dy],[x0,y0,dy0])
% 0
d3y=2+2*dy^2+2*y*d2y
d3y0=subs(d3y,[x,y,dy,d2y],[x0,y0,dy0,d2y0])
% 2
y1(x)=y0+dy0*x+1/2*d2y0*x^2+1/6*d3y0*x^3
% x^3/3
digits(3)
X=0:h:0.4
%  0    0.1000    0.2000    0.3000    0.4000
Y=vpa(y1(X))
% [ 0, 3.33e-4, 0.00267, 0.009, 0.0213]
for i=1:3
    D_Y(i)=Y(i+1)-Y(i);
end
D_Y
Q=h*f(X,Y)
% [ 0, 0.001, 0.004, 0.00901, 0.016]
for i=1:3
    D_Q(i)=Q(i+1)-Q(i);
end
D_Q
% [ 0.001, 0.003, 0.00501]
for i=1:2
    D2_Q(i)=D_Q(i+1)-D_Q(i);
end
D2_Q
% [ 0.002, 0.00201]
D3_Q=D2_Q(2)-D2_Q(1)
% 6.0e-6
D_y3=Q(4)+1/2*D_Q(3)+5/12*D2_Q(2)+3/8*D3_Q
% 0.0124
Y(5)=Y(4)+D_y3
% [ 0, 3.33e-4, 0.00267, 0.009, 0.0214]
