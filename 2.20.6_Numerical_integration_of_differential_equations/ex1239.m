% y'=x+y
% y(0)=1
% h=0.1
% y(0.5)-?
clear
syms x y
x0=0
y0=1
h=0.1
f(x,y)=x+y
dy=x+y
dy0=subs(dy,[x,y],[x0,y0])  
% 1
d2y=2
d2y0=subs(d2y,[x,y,dy],[x0,y0,dy0])
% 2
d3y=0
d3y0=subs(d3y,[x,y,dy,d2y],[x0,y0,dy0,d2y0])
% 0
y1(x)=y0+dy0*x+1/2*d2y0*x^2+1/6*d3y0*x^3
% x^2 + x + 1
digits(3)
X=0:h:0.5
% 0    0.1000    0.2000    0.3000    0.4000    0.5000
Y=vpa(y1(X))
% [ 1.0, 1.11, 1.24, 1.39, 1.56, 1.75]
for i=1:4
    D_Y(i)=Y(i+1)-Y(i);
end
D_Y
% [ 0.11, 0.13, 0.15, 0.17]
Q=h*f(X,Y)
% [ 0.1, 0.121, 0.144, 0.169, 0.196, 0.225]
for i=1:4
    D_Q(i)=Q(i+1)-Q(i);
end
D_Q
% [ 0.021, 0.023, 0.025, 0.027]
for i=1:3
    D2_Q(i)=D_Q(i+1)-D_Q(i);
end
D2_Q
% [ 0.002, 0.002, 0.002]
for i=1:2
    D3_Q(i)=D2_Q(i+1)-D2_Q(i);
end
D3_Q
% [ -1.82e-12, -3.64e-12]
D4_Q=D3_Q(2)-D3_Q(1)
% -1.82e-12
D_y4=Q(5)+1/2*D_Q(4)+5/12*D2_Q(3)+3/8*D3_Q(2)
% 0.21
Y(6)=Y(5)+D_y4
% [ 1.0, 1.11, 1.24, 1.39, 1.56, 1.77]
