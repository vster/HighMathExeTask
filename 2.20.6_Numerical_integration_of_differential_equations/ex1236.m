% Runge-Kutta method
% 4*y'=y^2+4*x^2
% y(0)=-1
% [0;1]
% h=0.1
clear
digits(4)
syms x y
f(x,y)=y^2/4+x^2
X(1)=0;
h=0.1;
X=X(1):h:1
%          0    0.1000    0.2000    0.3000    0.4000    0.5000    0.6000    0.7000    0.8000    0.9000    1.0000
Y(1)=-1;
for i=1:10
    K=zeros(1,4);
    K(1)=vpa(h*f(X(i),Y(i)));
    K(2)=vpa(h*f(X(i)+h/2,Y(i)+K(1)/2));
    K(3)=vpa(h*f(X(i)+h/2,Y(i)+K(2)/2));
    K(4)=vpa(h*f(X(i)+h,Y(i)+K(3)));
    D_y=vpa(1/6*(K(1)+2*K(2)+2*K(3)+K(4)));
    Y(i+1)=Y(i)+D_y;
end
Y
%    -1.0000   -0.9753   -0.9498   -0.9216   -0.8888   -0.8496   -0.8022   -0.7449   -0.6759   -0.5934   -0.4956