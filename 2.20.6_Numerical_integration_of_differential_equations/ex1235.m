% Runge-Kutta method
% x^2*y'-x*y=1
% y(1)=0
% [1;2]
% h=0.2
% y=(x^2-1)/(2*x)
clear
digits(4)
syms x y
f(x,y)=y/x+1/x^2
X(1)=1;
h=0.2;
X=X(1):h:2
%     1.0000    1.2000    1.4000    1.6000    1.8000    2.0000
Y1=(X.^2-1)./(2*X)
%          0    0.1833    0.3429    0.4875    0.6222    0.7500
Y(1)=0;
for i=1:5
    K=zeros(1,4);
    K(1)=vpa(h*f(X(i),Y(i)));
    K(2)=vpa(h*f(X(i)+h/2,Y(i)+K(1)/2));
    K(3)=vpa(h*f(X(i)+h/2,Y(i)+K(2)/2));
    K(4)=vpa(h*f(X(i)+h,Y(i)+K(3)));
    D_y=vpa(1/6*(K(1)+2*K(2)+2*K(3)+K(4)));
    Y(i+1)=Y(i)+D_y;
end
Y
%          0    0.1834    0.3429    0.4876    0.6224    0.7502