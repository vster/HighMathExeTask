% Normal distribution
clear
digits(5)
I=[0 3 6 9 12 15 18 21 24 27]
nx=[1 3 4 6 11 10 7 5 2 1]

X=I+1.5
%    1.5000    4.5000    7.5000   10.5000   13.5000   16.5000   19.5000   22.5000
%    25.5000   28.5000
n=sum(nx)
% 50
W=nx/n
%    0.0200    0.0600    0.0800    0.1200    0.2200    0.2000    0.1400
%    0.1000    0.0400    0.0200
% X=3*T-1.5
T=[1 2 3 4 5 6 7 8 9 10]
T2=T.^2
% 1     4     9    16    25    36    49    64    81   100
MT=sum(T.*W)
% 5.5000
MT2=sum(T2.*W)
% 34.1000
MX=3*MT-1.5
% 15.0000
sig2x=3^2*(MT2-MT^2)
% 34.6500
sigx=sqrt(sig2x)
% 5.8864
sigx=5.9
syms x
f=1/(sigx*sqrt(sym(2)*pi))*exp(-(x-MX)^2/(2*sigx^2))

U=(X-15)/5.9
%    -2.2881   -1.7797   -1.2712   -0.7627   -0.2542    0.2542    0.7627
%    1.2712    1.7797    2.2881
Zu=1/sqrt(2*pi)*exp(-U.^2/2)
%     0.0291    0.0819    0.1778    0.2983    0.3863    0.3863    0.2983
%     0.1778    0.0819    0.0291
fx=0.17*Zu
%     0.0049    0.0139    0.0302    0.0507    0.0657    0.0657    0.0507
%     0.0302    0.0139    0.0049
h=3
hfx=h*fx
%     0.0148    0.0418    0.0907    0.1521    0.1970    0.1970    0.1521
%     0.0907    0.0418    0.0148
sig=sigx
m=MX
digits(2)
for i=1:10
    a=I(i);
    b=I(i)+3;
    % P(<a<X<b)
    Pab(i)=1/2*(erf((b-m)/(sig*sqrt(2)))-erf((a-m)/(sig*sqrt(2))));
end
disp(Pab)
%     0.0155    0.0426    0.0910    0.1510    0.1944    0.1944    0.1510
%     0.0910    0.0426    0.0155


