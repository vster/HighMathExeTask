clear
digits(4)
I=[0:5:45]
nx=[2 12 8 4 14 6 10 2 1 11]

n=sum(nx)
% 70
X=I+2.5
%     2.5000    7.5000   12.5000   17.5000   22.5000   27.5000   32.5000   37.5000   42.5000
%   47.5000
W=nx/n
%    0.0286    0.1714    0.1143    0.0571    0.2000    0.0857    0.1429    0.0286    0.0143
%    0.1571
MX=sum(X.*W)
% 24.4286
MX2=sum(X.^2.*W)
% 782.6786
DX=MX2-MX^2
% 185.9235
sigx=sqrt(DX)
% 13.6354
syms a b
eq1=(a+b)/2-MX
eq2=(b-a)/(2*sqrt(3))-sigx
[a1 b1]=solve([eq1 eq2],[a b])
a1=vpa(a1)
% 0.8114
b1=vpa(b1)
% 48.05

syms x
f=piecewise(x<a1,0,a1<=x<=b1,1/(b1-a1),x>b1,0)

for i=1:10
    P(i)=int(f,x,5*(i-1),5*i);
end
P
% [ 0.08868, 0.1059, 0.1059, 0.1059, 0.1059, 0.1059, 0.1059, 0.1059, 0.1059, 0.06448]
W-P
% 
(W-P).^2
% [ -0.06011, 0.06557, 0.00843, -0.04871, 0.09414, -0.02014, 0.037, -0.07728, -0.09157, 0.09266]
(W-P).^2./P
% [ 0.003613, 0.0043, 7.107e-5, 0.002373, 0.008863, 0.0004057, 0.001369, 0.005973, 0.008385, 0.008586]
ss=sum((W-P).^2./P)
% 0.4737
hi2=n*ss
% 33.16
l=10
t=3
r=7
% If hi2=30 then P=0.0001
% If hi2=33.16 then P<0.0001 < 0.1
% In this case, the theory reproduces poorly the experience.

kr=abs(33.16-7)/sqrt(2*7)
% 6.9916 > 3