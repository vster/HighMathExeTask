% Charlier distribution
I=[0 3 6 9 12 15 18 21 24 27]
nx=[1 5 8 15 28 21 10 6 3 3]

n=sum(nx)
% 100
T=1:10
X=3*T-1.5
%   1.5000    4.5000    7.5000   10.5000   13.5000   16.5000   19.5000   22.5000   25.5000
%   28.5000
W=nx/n
%    0.0100    0.0500    0.0800    0.1500    0.2800    0.2100    0.1000    0.0600    0.0300
%    0.0300
MT=sum(W.*T)
% 5.3600
MX=3*MT-1.5
% 14.5800
MT2=sum(W.*T.^2)
% 32.0600
DT=MT2-MT^2
% 3.3304
sigt=sqrt(DT)
% 1.8249
sigx=3*sigt
% 5.4748
MT3=sum(W.*T.^3)
% 209.4200
MT4=sum(W.*T.^4)
% 1.4755e+03

alfa1=MT
alfa2=MT2
alfa3=MT3
alfa4=MT4

mu3t=alfa3-3*alfa1*alfa2+2*alfa1^3
% 1.8765
Skt=mu3t/sigt^3
% 0.3087
mu4t=alfa4-4*alfa1*alfa3+6*alfa1^2*alfa2-3*alfa1^4
% 35.8313
sig4t=DT^2
% 11.0916
Ext=mu4t/sig4t-3
% 0.2305
Exx=Ext
% 0.2305

h=3
m=MX
syms x
u=(x-m)/sigx
% (25*2^(1/2)*4163^(1/2)*(x - 729/50))/12489
Skx=Skt

digits(3)
X
%  1.50 4.5  7.50 10.50 13.50 16.50 19.50 22.50 25.50 28.50
U=(X-m)/sigx
%   -2.3891   -1.8412   -1.2932   -0.7452   -0.1973    0.3507    0.8987    1.4466    1.9946
%    2.5426
Zu=1/sqrt(2*pi)*exp(-U.^2/2)
%  0.0230    0.0733    0.1729    0.3022    0.3913    0.3751    0.2664    0.1401    0.0546
%    0.0157
P=h/sigx*Zu.*(1+Skx/6*(U.^3-3*U)+Exx/24*(U.^4-6*U.^2+3))
% 0.0086    0.0364    0.0993    0.1811    0.2265    0.1994    0.1295    0.0678    0.0315
%    0.0130
plot(X,W,X,P)
grid
